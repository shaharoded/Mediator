<?xml version="1.0" encoding="UTF-8"?>
<state name="BOLUS_BITZUA_STATE">
    <categories>Medications</categories>
    <description>Abstraction for the dosage and route of administration of BOLUS insulin</description>
    <derived-from name="BOLUS_BITZUA" tak="raw-concept"/>
    
    <!-- Concatenate adjacent equal states within these windows; allow 1 outlier skip -->
    <persistence good-after="8h" interpolate="true" max-skip="1"/>

    <!-- Discretization rules by values in order of appearance in the tuple (idx) -->
    <!-- Range treated as min_value <= X < max_value -->
    <discretization-rules>
        <attribute idx="0">
            <rule value="Very Low" min="0" max="4"/>
            <rule value="Low" min="4" max="10"/>
            <rule value="Medium" min="10" max="20"/>
            <rule value="High" min="20" max="30"/>
            <rule value="Very High" min="30"/>
        </attribute>
        <!-- idx="1" (route) is nominal; no discretization needed -->
    </discretization-rules>

    <!-- Once all values are discrete, they can be abstracted -->
    <abstraction-rules order="first">
        <rule value="SubCutaneous Low" operator="and">
            <attribute idx="0">
                <allowed-value equal="Very Low"/>
                <allowed-value equal="Low"/>
            </attribute>
            <attribute idx="1">
                <allowed-value equal="SubCutaneous"/>
            </attribute>
        </rule>
        <rule value="IntraVenous Low" operator="and">
            <attribute idx="0">
                <allowed-value equal="Very Low"/>
                <allowed-value equal="Low"/>
            </attribute>
            <attribute idx="1">
                <allowed-value equal="IntraVenous"/>
            </attribute>
        </rule>
        <rule value="SubCutaneous Medium" operator="and">
            <attribute idx="0">
                <allowed-value equal="Medium"/>
            </attribute>
            <attribute idx="1">
                <allowed-value equal="SubCutaneous"/>
            </attribute>
        </rule>
        <rule value="IntraVenous Medium" operator="and">
            <attribute idx="0">
                <allowed-value equal="Medium"/>
            </attribute>
            <attribute idx="1">
                <allowed-value equal="IntraVenous"/>
            </attribute>
        </rule>
        <rule value="SubCutaneous High" operator="and">
            <attribute idx="0">
                <allowed-value equal="High"/>
                <allowed-value equal="Very High"/>
            </attribute>
            <attribute idx="1">
                <allowed-value equal="SubCutaneous"/>
            </attribute>
        </rule>
        <rule value="IntraVenous High" operator="and">
            <attribute idx="0">
                <allowed-value equal="High"/>
                <allowed-value equal="Very High"/>
            </attribute>
            <attribute idx="1">
                <allowed-value equal="IntraVenous"/>
            </attribute>
        </rule>
        <rule value="Low" operator="and">
            <attribute idx="0">
                <allowed-value equal="Very Low"/>
                <allowed-value equal="Low"/>
            </attribute>
        </rule>
        <rule value="Medium" operator="and">
            <attribute idx="0">
                <allowed-value equal="Medium"/>
            </attribute>
        </rule>
        <rule value="High" operator="and">
            <attribute idx="0">
                <allowed-value equal="High"/>
                <allowed-value equal="Very High"/>
            </attribute>
        </rule>
    </abstraction-rules>
</state>